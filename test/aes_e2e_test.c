#include "incaes/rijndael.h"
#include "incaes/def.h"
#include "test.h"
#include <stdlib.h>

void test_aes_128_enc(void) {
    byte plaintext[16] = { 0x32u, 0x43u, 0xf6u, 0xa8u, 0x88u, 0x5au, 0x30u, 0x8du, 0x31u, 0x31u, 0x98u, 0xa2u, 0xe0u, 0x37u, 0x07u, 0x34u };
    byte key[16] = { 0x2bu, 0x7eu, 0x15u, 0x16u, 0x28u, 0xaeu, 0xd2u, 0xa6u, 0xabu, 0xf7u, 0x15u, 0x88u, 0x09u, 0xcfu, 0x4fu, 0x3cu };

    byte expected_ciphertext[] = { 0x39u, 0x25u, 0x84u, 0x1du, 0x02u, 0xdcu, 0x09u, 0xfbu, 0xdcu, 0x11u, 0x85u, 0x97u, 0x19u, 0x6au, 0x0bu, 0x32u };

    block output = aes_128_enc(plaintext, key);

    for (int i = 0; i < 16; i++) {
        ASSERT_EQ(output[i], expected_ciphertext[i]);
    }

    free(output);
}

void test_aes_128_dec(void) {
    byte ciphertext[] = { 0x39u, 0x25u, 0x84u, 0x1du, 0x02u, 0xdcu, 0x09u, 0xfbu, 0xdcu, 0x11u, 0x85u, 0x97u, 0x19u, 0x6au, 0x0bu, 0x32u };
    byte key[16] = { 0x2bu, 0x7eu, 0x15u, 0x16u, 0x28u, 0xaeu, 0xd2u, 0xa6u, 0xabu, 0xf7u, 0x15u, 0x88u, 0x09u, 0xcfu, 0x4fu, 0x3cu };

    byte expected_plaintext[16] = { 0x32u, 0x43u, 0xf6u, 0xa8u, 0x88u, 0x5au, 0x30u, 0x8du, 0x31u, 0x31u, 0x98u, 0xa2u, 0xe0u, 0x37u, 0x07u, 0x34u };

    block output = aes_128_dec(ciphertext, key);

    for (int i = 0; i < 16; i++) {
        ASSERT_EQ(output[i], expected_plaintext[i]);
    }

    free(output);
}

void test_aes_192_enc(void) {
    byte plaintext[16] = { 0x6bu, 0xc1u, 0xbeu, 0xe2u, 0x2eu, 0x40u, 0x9fu, 0x96u, 0xe9u, 0x3du, 0x7eu, 0x11u, 0x73u, 0x93u, 0x17u, 0x2au };
    byte key[24] = { 0x8eu, 0x73u, 0xb0u, 0xf7u, 0xdau, 0x0eu, 0x64u, 0x52u, 0xc8u, 0x10u, 0xf3u, 0x2bu, 0x80u, 0x90u, 0x79u, 0xe5u, 0x62u, 0xf8u, 0xeau, 0xd2u, 0x52u, 0x2cu, 0x6bu, 0x7bu };

    byte expected_ciphertext[] = { 0xbdu, 0x33u, 0x4fu, 0x1du, 0x6eu, 0x45u, 0xf2u, 0x5fu, 0xf7u, 0x12u, 0xa2u, 0x14u, 0x57u, 0x1fu, 0xa5u, 0xccu };

    block output = aes_192_enc(plaintext, key);

    for (int i = 0; i < 16; i++) {
        ASSERT_EQ(output[i], expected_ciphertext[i]);
    }

    free(output);
}

void test_aes_192_dec(void) {
    byte ciphertext[16] = { 0xbdu, 0x33u, 0x4fu, 0x1du, 0x6eu, 0x45u, 0xf2u, 0x5fu, 0xf7u, 0x12u, 0xa2u, 0x14u, 0x57u, 0x1fu, 0xa5u, 0xccu };
    byte key[24] = { 0x8eu, 0x73u, 0xb0u, 0xf7u, 0xdau, 0x0eu, 0x64u, 0x52u, 0xc8u, 0x10u, 0xf3u, 0x2bu, 0x80u, 0x90u, 0x79u, 0xe5u, 0x62u, 0xf8u, 0xeau, 0xd2u, 0x52u, 0x2cu, 0x6bu, 0x7bu };

    byte expected_plaintext[16] = { 0x6bu, 0xc1u, 0xbeu, 0xe2u, 0x2eu, 0x40u, 0x9fu, 0x96u, 0xe9u, 0x3du, 0x7eu, 0x11u, 0x73u, 0x93u, 0x17u, 0x2au };

    block output = aes_192_dec(ciphertext, key);

    for (int i = 0; i < 16; i++) {
        ASSERT_EQ(output[i], expected_plaintext[i]);
    }

    free(output);
}

void test_aes_256_enc(void) {
    byte plaintext[16] = { 0x6bu, 0xc1u, 0xbeu, 0xe2u, 0x2eu, 0x40u, 0x9fu, 0x96u, 0xe9u, 0x3du, 0x7eu, 0x11u, 0x73u, 0x93u, 0x17u, 0x2au };
    byte key[32] = { 0x60u, 0x3du, 0xebu, 0x10u, 0x15u, 0xcau, 0x71u, 0xbeu, 0x2bu, 0x73u, 0xaeu, 0xf0u, 0x85u, 0x7du, 0x77u, 0x81u, 0x1fu, 0x35u, 0x2cu, 0x07u, 0x3bu, 0x61u, 0x08u, 0xd7u, 0x2du, 0x98u, 0x10u, 0xa3u, 0x09u, 0x14u, 0xdfu, 0xf4u };

    byte expected_ciphertext[] = { 0xf3u, 0xeeu, 0xd1u, 0xbdu, 0xb5u, 0xd2u, 0xa0u, 0x3cu, 0x06u, 0x4bu, 0x5au, 0x7eu, 0x3du, 0xb1u, 0x81u, 0xf8u };

    block output = aes_256_enc(plaintext, key);

    for (int i = 0; i < 16; i++) {
        ASSERT_EQ(output[i], expected_ciphertext[i]);
    }

    free(output);
}

void test_aes_256_dec(void) {
    byte ciphertext[16] = { 0xbdu, 0x33u, 0x4fu, 0x1du, 0x6eu, 0x45u, 0xf2u, 0x5fu, 0xf7u, 0x12u, 0xa2u, 0x14u, 0x57u, 0x1fu, 0xa5u, 0xccu };
    byte key[24] = { 0x8eu, 0x73u, 0xb0u, 0xf7u, 0xdau, 0x0eu, 0x64u, 0x52u, 0xc8u, 0x10u, 0xf3u, 0x2bu, 0x80u, 0x90u, 0x79u, 0xe5u, 0x62u, 0xf8u, 0xeau, 0xd2u, 0x52u, 0x2cu, 0x6bu, 0x7bu };

    byte expected_plaintext[16] = { 0x6bu, 0xc1u, 0xbeu, 0xe2u, 0x2eu, 0x40u, 0x9fu, 0x96u, 0xe9u, 0x3du, 0x7eu, 0x11u, 0x73u, 0x93u, 0x17u, 0x2au };

    block output = aes_256_dec(ciphertext, key);

    for (int i = 0; i < 16; i++) {
        ASSERT_EQ(output[i], expected_plaintext[i]);
    }

    free(output);
}

int main(void) {
    test_aes_128_enc();
    test_aes_128_dec();
    test_aes_192_enc();
    test_aes_192_dec();
}

