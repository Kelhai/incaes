#include "incaes/rijndael.h"
#include "incaes/def.h"
#include "test.h"
#include <stdlib.h>

void test_aes_128_enc(void) {
    byte plaintext[16] = { 0x32u, 0x43u, 0xf6u, 0xa8u, 0x88u, 0x5au, 0x30u, 0x8du, 0x31u, 0x31u, 0x98u, 0xa2u, 0xe0u, 0x37u, 0x07u, 0x34u };
    byte key[16] = { 0x2bu, 0x7eu, 0x15u, 0x16u, 0x28u, 0xaeu, 0xd2u, 0xa6u, 0xabu, 0xf7u, 0x15u, 0x88u, 0x09u, 0xcfu, 0x4fu, 0x3cu };

    byte expected_ciphertext[] = { 0x39u, 0x25u, 0x84u, 0x1du, 0x02u, 0xdcu, 0x09u, 0xfbu, 0xdcu, 0x11u, 0x85u, 0x97u, 0x19u, 0x6au, 0x0bu, 0x32u };

    block output = aes_128_enc(plaintext, key);

    for (int i = 0; i < 16; i++) {
        ASSERT_EQ(output[i], expected_ciphertext[i]);
    }

    free(output);
}

void test_aes_128_dec(void) {
    byte ciphertext[] = { 0x39u, 0x25u, 0x84u, 0x1du, 0x02u, 0xdcu, 0x09u, 0xfbu, 0xdcu, 0x11u, 0x85u, 0x97u, 0x19u, 0x6au, 0x0bu, 0x32u };
    byte key[16] = { 0x2bu, 0x7eu, 0x15u, 0x16u, 0x28u, 0xaeu, 0xd2u, 0xa6u, 0xabu, 0xf7u, 0x15u, 0x88u, 0x09u, 0xcfu, 0x4fu, 0x3cu };

    byte expected_plaintext[16] = { 0x32u, 0x43u, 0xf6u, 0xa8u, 0x88u, 0x5au, 0x30u, 0x8du, 0x31u, 0x31u, 0x98u, 0xa2u, 0xe0u, 0x37u, 0x07u, 0x34u };

    block output = aes_128_dec(ciphertext, key);

    for (int i = 0; i < 16; i++) {
        ASSERT_EQ(output[i], expected_plaintext[i]);
    }

    free(output);
}

int main(void) {
    test_aes_128_enc();
    test_aes_128_dec();
}
